var user=new Vue({el:"#lesson-content-detail",data:function(){return{tasks:lesson_tasks,answers:lesson_answers,lesson:lesson_lesson,results:lesson_results,writeQuestions:lesson_writeQuestions,tokenMp3:lesson_tokenMp3,currentResult:{},resultData:{},userScore:0,tokenPlayMp3:0,currentIndex:-1}},methods:{checkEmptyAnswer:function(){for(var e=this,t=0;t<e.tasks.length;t++){var s=e.tasks[t].id;if(3==e.tasks[t].type){for(var r=0;r<e.answers[s].length;r++)if($("#answer"+e.answers[s][r].id).is(":checked"))return!1}else if(6==e.tasks[t].type)for(var r=0;r<e.writeQuestions[s].length;r++)if(null!=$("#write-question"+s+"-"+e.writeQuestions[s][r].id).val()&&void 0!=$("#write-question"+s+"-"+e.writeQuestions[s][r].id).val()&&""!=$("#write-question"+s+"-"+e.writeQuestions[s][r].id).val())return!1}return!0},sendTestResult:function(e){var t=this;if(t.checkEmptyAnswer())return void $("#empty_answers").modal("toggle");for(var s=0,r={},n=0;n<t.tasks.length;n++){var a=t.tasks[n].id;if(3==t.tasks[n].type){var i=$("input[name='task"+a+"']:checked").next().text(),o=$("input[name='task"+a+"']:checked").prev().text(),u={};u.value=o+"",u.feedback="",r[a]=u,void 0!=i&&null!=i&&""!=i||(i=0),s+=parseInt(i),$("input[name='task"+a+"']:checked").prop("checked",!1)}else if(6==t.tasks[n].type){for(var l={},c=0;c<t.writeQuestions[a].length;c++){var d=t.writeQuestions[a][c].id,u=$("#write-question"+a+"-"+d).val();l[d+""]=u,u==t.writeQuestions[a][c].answer&&(s+=parseInt(t.writeQuestions[a][c].grade)),$("#write-question"+a+"-"+d).val("")}r[a]=l}}if(t.userScore=s,$("#myMessage").modal(),"no-auth"!=e){r=JSON.stringify(r);var v=s>t.lesson.pass_marks,w=new Date;w=Math.floor(w.getTime()/1e3),dataResult={lesson_id:t.lesson.id,grade:s,data:r,total_grade:t.lesson.total_marks,passed:v,created:w},$.ajax({url:window.location.origin+"/khoa-hoc/gui-ket-qua",type:"POST",data:dataResult,async:!0,error:function(){},success:function(e){t.results.unshift(e)}})}},printTime:function(e){var t=this,s=new Date(1e3*e);return t.convertNumber(s.getHours())+":"+t.convertNumber(s.getMinutes())},printDate:function(e){var t=this,s=new Date(1e3*e);return t.convertNumber(s.getDate())+"/"+t.convertNumber(s.getMonth()+1)+"/"+s.getFullYear()},convertNumber:function(e){return e<10?"0"+e:e+""},reviewTestResult:function(e){var t=this;t.currentResult=t.results[e],t.resultData=JSON.parse(t.currentResult.data);for(var s=0;s<t.tasks.length;s++){var r=t.tasks[s].id;if(3==parseInt(t.tasks[s].type)){var n=t.resultData[t.tasks[s].id];if(void 0!=n&&void 0!=n.value&&""!=n.value){answerValue=n.value;for(var a=0;a<t.answers[r].length;a++)t.answers[r][a].checked=!1,t.answers[r][a].id==answerValue&&(t.answers[r][a].checked=!0)}else for(var a=0;a<t.answers[r].length;a++)t.answers[r][a].checked=!1}}},removeTestResult:function(e){var t=this;t.currentIndex=e},confirmRemove:function(){var e=this,t={result_id:e.results[e.currentIndex].id};$.ajax({url:window.location.origin+"/account/delete-test-result",type:"DELETE",data:t,async:!0,error:function(){},success:function(e){}}),e.results.splice(e.currentIndex,1),$("#removeResult").modal("toggle")}},mounted:function(){$("#result").css("display","block"),$(".server-localtion-container").css("display","block")}});